SUBDIRS=   \
 python

lib_LTLIBRARIES = libotestpoint-probe-iptraffic.la

libotestpoint_probe_iptraffic_la_CPPFLAGS=  \
 $(libxml2_CFLAGS) \
 $(libotestpoint_CFLAGS) \
 $(protobuf_CFLAGS) \
 $(pcap_CFLAGS)

BUILT_SOURCES = \
 iptraffic.pb.cc \
 iptraffic.pb.h \
 measurementtable.pb.cc \
 measurementtable.pb.h                  

libotestpoint_probe_iptraffic_la_SOURCES = \
 iptraffic.pb.cc \
 measurementtable.pb.cc \
 probe.cc

EXTRA_DIST = \
 probe.h \
 iptraffic.proto

# SCHEMAS= \
#  probe-iptraffic

PROTOS= \
 iptraffic.proto                            

libotestpoint_probe_iptraffic_la_LDFLAGS=  \
 -avoid-version

libotestpoint_probe_iptraffic_la_LIBADD = \
 $(libotestpoint_LIBS) \
 $(protobuf_LIBS) \
 $(pcap_LIBS)

iptraffic.pb.cc iptraffic.pb.h: iptraffic.proto
	protoc -I=. -I=$(libotestpoint_PROTODIR) --cpp_out=. $<

measurementtable.pb.cc measurementtable.pb.h: $(libotestpoint_PROTODIR)/measurementtable.proto
	protoc -I=$(libotestpoint_PROTODIR) --cpp_out=. $<

clean-local:
	rm -f $(BUILT_SOURCES)

install-exec-hook:	
	$(mkinstalldirs) $(DESTDIR)$(datadir)/$(PACKAGE)/proto/
	cp -f $(PROTOS) $(DESTDIR)$(datadir)/$(PACKAGE)/proto

uninstall-local:
	rm -f $(DESTDIR)$(datadir)/$(PACKAGE)/protos/*
